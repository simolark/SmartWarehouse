{"remainingRequest":"D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\node_modules\\babel-loader\\lib\\index.js!D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\src\\views\\Message.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\src\\views\\Message.vue","mtime":1666025552000},{"path":"D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665989346000},{"path":"D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\node_modules\\babel-loader\\lib\\index.js","mtime":1665989346000},{"path":"D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665989346000},{"path":"D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1665989348000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJlcXVlc3QgZnJvbSAiQC91dGlscy9yZXF1ZXN0IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNZXNzYWdlIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcjoge30sCiAgICAgIG1lc3NhZ2VzOiBbXSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICBpc0NvbGxhcHNlOiBmYWxzZSwKICAgICAgZW50aXR5OiB7fQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ1c2VyIikgPyBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXIiKSkgOiB7fTsKICAgIHRoaXMubG9hZE1lc3NhZ2UoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGxvYWRNZXNzYWdlOiBmdW5jdGlvbiBsb2FkTWVzc2FnZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vIOWmguaenOaYr+eVmeiogOeahOivne+8jOWwseWGmeatuz0wCiAgICAgIC8vIOWmguaenOaYryDor4TorrrvvIzliJnpnIDopoHorr7nva4g5b2T5YmN6KKr6K+E6K6655qE5qih5Z2X55qEaWTkvZzkuLpmb3JlaWduSWQKICAgICAgdmFyIGZvcmVpZ25JZCA9IDA7CiAgICAgIHJlcXVlc3QuZ2V0KCIvbWVzc2FnZS9mb3JlaWduLyIgKyBmb3JlaWduSWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzLm1lc3NhZ2VzID0gcmVzLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbDogZnVuY3Rpb24gY2FuY2VsKCkgewogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuZW50aXR5ID0ge307CiAgICB9LAogICAgcmVSZXBseTogZnVuY3Rpb24gcmVSZXBseShpZCkgewogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5lbnRpdHkucGFyZW50SWQgPSBpZDsKICAgIH0sCiAgICByZXBseTogZnVuY3Rpb24gcmVwbHkoKSB7CiAgICAgIHRoaXMuZW50aXR5LmNvbnRlbnQgPSB0aGlzLmVudGl0eS5yZXBseTsKICAgICAgdGhpcy5zYXZlKCk7CiAgICB9LAogICAgc2F2ZTogZnVuY3Rpb24gc2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMudXNlci51c2VybmFtZSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgbWVzc2FnZTogIuivt+eZu+W9lSIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5lbnRpdHkuY29udGVudCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgbWVzc2FnZTogIuivt+Whq+WGmeWGheWuuSIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8g5aaC5p6c5piv6K+E6K6655qE6K+d77yM5ZyoIHNhdmXnmoTml7blgJnopoHms6jmhI/orr7nva4g5b2T5YmN5qih5Z2X55qEaWTkuLogZm9yZWlnbklk44CC5Lmf5bCx5pivICBlbnRpdHkuZm9yZWlnbklkID0g5qih5Z2XaWQKCgogICAgICByZXF1ZXN0LnBvc3QoIi9tZXNzYWdlIiwgdGhpcy5lbnRpdHkpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGlmIChyZXMuY29kZSA9PT0gJzAnKSB7CiAgICAgICAgICBfdGhpczIuJG1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAi6K+E6K665oiQ5YqfIiwKICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMyLiRtZXNzYWdlKHsKICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1zZywKICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBfdGhpczIuZW50aXR5ID0ge307CgogICAgICAgIF90aGlzMi5sb2FkTWVzc2FnZSgpOwoKICAgICAgICBfdGhpczIuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgZGVsOiBmdW5jdGlvbiBkZWwoaWQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXF1ZXN0LmRlbGV0ZSgiL21lc3NhZ2UvIiArIGlkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczMuJG1lc3NhZ2UoewogICAgICAgICAgbWVzc2FnZTogIuWIoOmZpOaIkOWKnyIsCiAgICAgICAgICB0eXBlOiAic3VjY2VzcyIKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMzLmxvYWRNZXNzYWdlKCk7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["D:\\A_University\\Study\\实训三\\代码\\新建文件夹\\前端\\src\\views\\Message.vue"],"names":[],"mappings":"AA8CA,OAAO,OAAP,MAAoB,iBAApB;AAEA,eAAe;AACb,EAAA,IAAI,EAAE,SADO;AAEb,EAAA,IAFa,kBAEN;AACL,WAAO;AACL,MAAA,IAAI,EAAE,EADD;AAEL,MAAA,QAAQ,EAAE,EAFL;AAGL,MAAA,iBAAiB,EAAE,KAHd;AAIL,MAAA,UAAU,EAAE,KAJP;AAKL,MAAA,MAAM,EAAE;AALH,KAAP;AAOD,GAVY;AAWb,EAAA,OAXa,qBAWH;AACR,SAAK,IAAL,GAAY,cAAc,CAAC,OAAf,CAAuB,MAAvB,IAAiC,IAAI,CAAC,KAAL,CAAW,cAAc,CAAC,OAAf,CAAuB,MAAvB,CAAX,CAAjC,GAA8E,EAA1F;AACA,SAAK,WAAL;AAGD,GAhBY;AAiBb,EAAA,OAAO,EAAE;AACP,IAAA,WADO,yBACO;AAAA;;AACZ;AACA;AACA,UAAI,SAAQ,GAAI,CAAhB;AACA,MAAA,OAAO,CAAC,GAAR,CAAY,sBAAsB,SAAlC,EAA6C,IAA7C,CAAkD,UAAA,GAAE,EAAK;AACvD,QAAA,KAAI,CAAC,QAAL,GAAgB,GAAG,CAAC,IAApB;AACD,OAFD;AAGD,KARM;AASP,IAAA,MATO,oBASE;AACP,WAAK,iBAAL,GAAyB,KAAzB;AACA,WAAK,MAAL,GAAc,EAAd;AACD,KAZM;AAaP,IAAA,OAbO,mBAaC,EAbD,EAaK;AACV,WAAK,iBAAL,GAAyB,IAAzB;AACA,WAAK,MAAL,CAAY,QAAZ,GAAuB,EAAvB;AACD,KAhBM;AAiBP,IAAA,KAjBO,mBAiBC;AACN,WAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,MAAL,CAAY,KAAlC;AACA,WAAK,IAAL;AACD,KApBM;AAsBP,IAAA,IAtBO,kBAsBA;AAAA;;AACL,UAAI,CAAC,KAAK,IAAL,CAAU,QAAf,EAAyB;AACvB,aAAK,QAAL,CAAc;AACZ,UAAA,OAAO,EAAE,KADG;AAEZ,UAAA,IAAI,EAAE;AAFM,SAAd;AAIA;AACF;;AACA,UAAI,CAAC,KAAK,MAAL,CAAY,OAAjB,EAA0B;AACxB,aAAK,QAAL,CAAc;AACZ,UAAA,OAAO,EAAE,OADG;AAEZ,UAAA,IAAI,EAAE;AAFM,SAAd;AAIA;AACF,OAdK,CAeL;;;AACA,MAAA,OAAO,CAAC,IAAR,CAAa,UAAb,EAAyB,KAAK,MAA9B,EAAsC,IAAtC,CAA2C,UAAA,GAAE,EAAK;AAChD,YAAI,GAAG,CAAC,IAAJ,KAAa,GAAjB,EAAsB;AACpB,UAAA,MAAI,CAAC,QAAL,CAAc;AACZ,YAAA,OAAO,EAAE,MADG;AAEZ,YAAA,IAAI,EAAE;AAFM,WAAd;AAIF,SALA,MAKO;AACL,UAAA,MAAI,CAAC,QAAL,CAAc;AACZ,YAAA,OAAO,EAAE,GAAG,CAAC,GADD;AAEZ,YAAA,IAAI,EAAE;AAFM,WAAd;AAIF;;AACA,QAAA,MAAI,CAAC,MAAL,GAAc,EAAd;;AACA,QAAA,MAAI,CAAC,WAAL;;AACA,QAAA,MAAI,CAAC,iBAAL,GAAyB,KAAzB;AACD,OAfD;AAgBD,KAtDM;AAuDP,IAAA,GAvDO,eAuDH,EAvDG,EAuDC;AAAA;;AACN,MAAA,OAAO,CAAC,MAAR,CAAe,cAAc,EAA7B,EAAiC,IAAjC,CAAsC,UAAA,GAAE,EAAK;AAC3C,QAAA,MAAI,CAAC,QAAL,CAAc;AACZ,UAAA,OAAO,EAAE,MADG;AAEZ,UAAA,IAAI,EAAE;AAFM,SAAd;;AAIA,QAAA,MAAI,CAAC,WAAL;AACD,OAND;AAOF;AA/DO;AAjBI,CAAf","sourcesContent":["<template>\n  <div style=\"margin-top: 10px; margin-bottom: 80px\">\n    <el-card>\n      <div style=\"padding: 20px; color: #888\">\n        <div>\n          <el-input type=\"textarea\" :rows=\"3\" v-model=\"entity.content\"></el-input>\n          <div style=\"text-align: right; padding: 10px\"><el-button type=\"primary\" @click=\"save\">留言</el-button></div>\n        </div>\n      </div>\n\n      <div style=\"display: flex; padding: 20px\" v-for=\"item in messages\">\n        <div style=\"text-align: center; flex: 1\">\n          <el-image :src=\"item.avatar\" style=\"width: 60px; height: 60px; border-radius: 50%\"></el-image>\n        </div>\n        <div style=\"padding: 0 10px; flex: 5\">\n          <div><b style=\"font-size: 14px\">{{ item.username }}</b></div>\n          <div style=\"padding: 10px 0; color: #888\">\n            {{ item.content }}\n            <el-button type=\"text\" size=\"mini\" @click=\"del(item.id)\" v-if=\"item.username === user.username\">删除</el-button>\n          </div>\n          <div style=\"background-color: #eee; padding: 10px\" v-if=\"item.parentMessage\">{{ item.username }}：{{ item.parentMessage.content }}</div>\n          <div style=\"color: #888; font-size: 12px\">\n            <span>{{ item.time  }}</span>\n            <el-button type=\"text\" style=\"margin-left: 20px\" @click=\"reReply(item.id)\">回复</el-button>\n          </div>\n        </div>\n      </div>\n\n      <el-dialog title=\"回复信息\" v-model=\"dialogFormVisible\" width=\"30%\">\n        <el-form :model=\"entity\" label-width=\"80px\">\n          <el-form-item label=\"内容\">\n            <el-input v-model=\"entity.reply\" autocomplete=\"off\" type=\"textarea\" :rows=\"3\"></el-input>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n          <el-button @click=\"cancel\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"reply\">确 定</el-button>\n        </template>\n      </el-dialog>\n    </el-card>\n\n\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\nexport default {\n  name: \"Message\",\n  data() {\n    return {\n      user: {},\n      messages: [],\n      dialogFormVisible: false,\n      isCollapse: false,\n      entity: {}\n    }\n  },\n  created() {\n    this.user = sessionStorage.getItem(\"user\") ? JSON.parse(sessionStorage.getItem(\"user\")) : {};\n    this.loadMessage();\n\n\n  },\n  methods: {\n    loadMessage() {\n      // 如果是留言的话，就写死=0\n      // 如果是 评论，则需要设置 当前被评论的模块的id作为foreignId\n      let foreignId = 0;\n      request.get(\"/message/foreign/\" + foreignId).then(res => {\n        this.messages = res.data;\n      })\n    },\n    cancel() {\n      this.dialogFormVisible = false;\n      this.entity = {};\n    },\n    reReply(id) {\n      this.dialogFormVisible = true;\n      this.entity.parentId = id;\n    },\n    reply() {\n      this.entity.content = this.entity.reply;\n      this.save();\n    },\n\n    save() {\n      if (!this.user.username) {\n        this.$message({\n          message: \"请登录\",\n          type: \"warning\"\n        });\n        return;\n      }\n      if (!this.entity.content) {\n        this.$message({\n          message: \"请填写内容\",\n          type: \"warning\"\n        });\n        return;\n      }\n      // 如果是评论的话，在 save的时候要注意设置 当前模块的id为 foreignId。也就是  entity.foreignId = 模块id\n      request.post(\"/message\", this.entity).then(res => {\n        if (res.code === '0') {\n          this.$message({\n            message: \"评论成功\",\n            type: \"success\"\n          });\n        } else {\n          this.$message({\n            message: res.msg,\n            type: \"error\"\n          });\n        }\n        this.entity = {}\n        this.loadMessage();\n        this.dialogFormVisible = false;\n      })\n    },\n    del(id) {\n      request.delete(\"/message/\" + id).then(res => {\n        this.$message({\n          message: \"删除成功\",\n          type: \"success\"\n        });\n        this.loadMessage()\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":""}]}